<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Octopress | ni-blog]]></title>
  <link href="http://niku4i.github.com/blog/categories/octopress/atom.xml" rel="self"/>
  <link href="http://niku4i.github.com/"/>
  <updated>2012-03-20T22:28:41+09:00</updated>
  <id>http://niku4i.github.com/</id>
  <author>
    <name><![CDATA[niku4i]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[OctopressのソースリポジトリをDropboxに変更]]></title>
    <link href="http://niku4i.github.com/blog/2012/03/18/change-upstream-of-source-to-dropbox/"/>
    <updated>2012-03-18T05:32:00+09:00</updated>
    <id>http://niku4i.github.com/blog/2012/03/18/change-upstream-of-source-to-dropbox</id>
    <content type="html"><![CDATA[<h3>octopressのソースファイルの管理</h3>

<p><a href="http://octopress.org/docs/deploying/github/">Deploying to Github Pages</a>の手順でgithub pagesを使うと、localのworking copyにはsourceというブランチが生成される。この環境でblogの記事を書くときは以下のワークフローをになってるとおもう。</p>

<ol>
<li><code>rake new_post['hoge']</code>で記事を作成</li>
<li><code>rake deploy</code>で記事を公開</li>
<li><code>git push</code>にてlocalhostのsourceブランチ -> github pagesのsourceブランチemote backup。</li>
</ol>


<p><code>rake deploy</code>するとgithubのmasterブランチにpublicディレクトリのみuploadされるのはよいが、<code>git push</code>にてsourceファイルも公開している。</p>

<p>個人的にはソースファイルは公開しなくてよいかなと考えた。
そこで、sourceブランチはgithub上にはpushするのではなく、 Dropbox上にリポジトリを作成し管理することにする。</p>

<h3>リポジトリ作成</h3>

<pre><code>mkdir -p ~/Dropbox/repos/ni-blog.git        
cd ~/Dropbox/repos/ni-blog.git              
git --bare init                           
</code></pre>

<h3>リモートリポジトリの追加</h3>

<p>リモートリポジトリの確認
現在のremoteのripositoryはoctopressとoriginの2種類。</p>

<pre><code>$ cd path/to/octopress
$ git remote -v                     
octopress       git://github.com/imathis/octopress.git (fetc
octopress       git://github.com/imathis/octopress.git (push
origin  git@github.com:niku4i/niku4i.github.com.git (fetch) 
origin  git@github.com:niku4i/niku4i.github.com.git (push)  
</code></pre>

<p>~/Dropbox/repos/ni-blog.gitをdropboxという名前で登録</p>

<pre><code>git remote add dropbox ~/Dropbox/repos/ni-blog.git
</code></pre>

<p>確認</p>

<pre><code>$ git remote -v                          
dropbox /Users/nikushi/Dropbox/repos/ni-blog.git (fetch)       
dropbox /Users/nikushi/Dropbox/repos/ni-blog.git (push)        
octopress       git://github.com/imathis/octopress.git (fetch) 
octopress       git://github.com/imathis/octopress.git (push)  
origin  git@github.com:niku4i/niku4i.github.com.git (fetch)    
origin  git@github.com:niku4i/niku4i.github.com.git (push)     
</code></pre>

<p>dropboxが追加されました。</p>

<h3>Dropboxのリポジトリにソースファイルをpushする</h3>

<p>まずbareで作成したDropboxのリポジトリにpush。-uを指定することで以降<code>git push</code>(引数なし)で実行可能になる。</p>

<pre><code>$ git push -u dropbox source                   
Counting objects: 4110, done.                                        
Delta compression using up to 4 threads.                             
Compressing objects: 100% (1598/1598), done.                         
Writing objects: 100% (4110/4110), 2.73 MiB, done.                   
Total 4110 (delta 2307), reused 3836 (delta 2197)                    
To /Users/nikushi/Dropbox/repos/ni-blog.git                          
 * [new branch]      source -&gt; source                                
 Branch source set up to track remote branch source from dropbox.     
</code></pre>

<p>以後<code>git push</code>を実行するとDropboxのリポジトリにバックアップされる。</p>

<p>本当にバックアップされたか確認する。<code>git clone</code>する際には-bでsourceブランチを指定する必要がある。</p>

<pre><code>mkdir ~/tmp/ &amp;&amp; cd ~/tmp/
git clone -b source ~/Dropbox/repos/ni-blog.git
cd ni-blog
ls
</code></pre>

<p>rake deployにてgithubに記事をアップロード、git pushにてDropboxにバックアップするワークフローに変更できた。しばらくこれで運用してみる。</p>
]]></content>
  </entry>
  
</feed>
